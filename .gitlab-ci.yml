# Use the compiler image
image: gcc:12

stages:
  - build_and_test

compile_and_run:
  stage: build_and_test

  # FIX: Install CMake before doing anything else
  before_script:
    - apt-get update && apt-get install -y cmake

  script:
    - echo "Preparing build directory..."
    - mkdir -p build
    - cd build

    - echo "Running CMake..."
    - cmake ..

    - echo "Compiling..."
    # Matches the executable name defined in CMakeLists.txt above
    - make VDSProject_Test

    - echo "Running unit tests..."
    # Matches the executable name defined in CMakeLists.txt above
    - ./VDSProject_Test